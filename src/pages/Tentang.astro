---
import MainLayout from "../layouts/MainLayout.astro";

const BASE_URL = "https://parkir.dpmptsp-surabaya.my.id";

/* ===== MENU ===== */
const menuOrder = [
  { key: "sambutan", label: "Sambutan", icon: "fa-microphone" },
  { key: "visi-misi", label: "Visi dan Misi", icon: "fa-bullseye" },
  { key: "struktur", label: "Struktur Organisasi", icon: "fa-sitemap" },
  { key: "piagam", label: "Piagam Pelayanan", icon: "fa-certificate" },
  { key: "budaya", label: "Budaya Pelayanan", icon: "fa-hands-helping" },
  { key: "motto-layanan", label: "Motto Pelayanan", icon: "fa-quote-right" },
  { key: "maklumat", label: "Maklumat Pelayanan", icon: "fa-scroll" },
  { key: "kompensasi", label: "Kompensasi Layanan", icon: "fa-hand-holding-usd" },
  { key: "ikm", label: "Indeks Kepuasan Masyarakat", icon: "fa-smile" },
  { key: "zona-integritas", label: "Zona Integritas", icon: "fa-shield-alt" },
];

/* ===== DEFAULT LOAD ===== */
const res = await fetch(`${BASE_URL}/api/v1/about-me/sambutan`);
const json = await res.json();
const contents = json?.data?.data || [];
---
 
<MainLayout title="Informasi Organisasi">

  <section id="gambar-sec" class="py-20 bg-white relative overflow-hidden">
        <!-- Background elements dengan animasi baru -->
        <div class="absolute inset-0 z-0">
            <div class="absolute top-10 left-10 w-24 h-24 bg-gradient-to-r from-yellow-400 to-yellow-300 rounded-full opacity-20 animate-bounce-soft animate-morph-border"></div>
            <div class="absolute top-1/3 right-20 w-32 h-32 bg-gradient-to-r from-blue-400 to-blue-300 rounded-full opacity-15 animate-rotate-3d"></div>
            <div class="absolute bottom-20 left-1/4 w-28 h-28 bg-gradient-to-r from-green-400 to-green-300 rounded-full opacity-20 animate-pulse-soft"></div>
            <div class="absolute top-1/2 right-1/3 w-20 h-20 bg-gradient-to-r from-red-400 to-red-300 rounded-full opacity-15 animate-wave"></div>
        </div>
        
        <div class="container mx-auto px-4 relative z-10">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                <div class="animate-slide-in-left animate__animated">
                    <div class="inline-block mb-6">
                        <span class="text-sm font-semibold text-blue-600 bg-blue-50 px-4 py-2 rounded-full animate-border-glow">
                            Tentang Kami
                        </span>
                    </div>
                    <h2 class="text-4xl font-bold text-blue-800 mb-8 gradient-text animate-text-shadow">
                        Tentang DPMPTSP Kota Surabaya
                    </h2>
                    <div class="space-y-6">
                        <p class="text-gray-700 text-lg leading-relaxed animate-fade-up delay-1 animate__animated" style="animation-play-state: running;">
                            Berdasarkan visi Dinas Penanaman Modal dan Pelayanan Terpadu Satu Pintu yang telah dirumuskan, terdapat tiga poin pokok yang terkandung di dalam visi tersebut yaitu terkait peningkatan investasi, pelayanan perizinan yang prima dan penggunaan teknologi informasi.
                        </p>
                        <p class="text-gray-700 text-lg leading-relaxed animate-fade-up delay-2 animate__animated" style="animation-play-state: running;">
                            Hal tersebut mengindikasikan bahwa peningkatan investasi sangat didukung dengan pelayanan perizinan prima yang akan diberikan kepada pelaku usaha dalam mengajukan izin investasi di wilayah Kota Surabaya.
                        </p>
                        <p class="text-gray-700 text-lg leading-relaxed animate-fade-up delay-3 animate__animated" style="animation-play-state: running;">
                            Pelayanan perizinan prima tersebut terkait dengan cepatnya proses pelayanan, persyaratan yang mudah dan juga jelasnya prosedur yang diberikan kepada masyarakat.
                        </p>
                        <div class="p-6 bg-gradient-to-r from-blue-50 to-yellow-50 rounded-2xl border-l-4 border-blue-600 animate-fade-up delay-4 animate__animated" style="animation-play-state: running;">
                            <p class="text-gray-700 font-medium">
                                <i class="fas fa-lightbulb text-yellow-500 mr-3 text-xl animate-pulse-soft"></i>
                                Untuk memudahkan proses pelayanan juga digunakan teknologi informasi seperti SSW (Surabaya Single Window) dan kedepannya akan digunakan SPIPISE untuk mendukung peningkatan jumlah investasi di Kota Surabaya.
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="relative animate-slide-in-right animate__animated">
                    <!-- Main container dengan efek glass dan border animasi -->
                    <div class="relative glass-effect p-8 rounded-3xl shadow-2xl gradient-border-animated transform transition-all duration-500 hover-scale-shadow">
                        <!-- Photo gallery dengan floating effect -->
                        <div class="relative h-96 flex items-center justify-center">
                            <!-- Main highlighted photo slideshow (center) -->
                            <div class="relative z-30 transform transition-all duration-700 hover:scale-110 animate-float-subtle">
                                <div class="bg-white p-2 rounded-xl shadow-2xl tilt-effect">
                                    <div id="main-slideshow" class="relative w-72 h-56 overflow-hidden rounded-lg">
                                        <!-- Slide 1 - Active -->
                                        <div class="main-slide absolute inset-0 transition-opacity duration-1000 opacity-100" data-index="0" style="transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1); opacity: 0; z-index: 1;">
                                            <img src="gambar/dpm3.jpg" alt="Kantor Pemerintah Surabaya" class="w-full h-full object-cover">
                                        </div>
                                        <!-- Slide 2 -->
                                        <div class="main-slide absolute inset-0 transition-opacity duration-1000 opacity-0" data-index="1" style="transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1); opacity: 1; z-index: 2;">
                                            <img src="gambar/SPP-PAKAL.jpeg" alt="Pelayanan Masyarakat" class="w-full h-full object-cover">
                                        </div>
                                        <!-- Slide 3 -->
                                        <div class="main-slide absolute inset-0 transition-opacity duration-1000 opacity-0" data-index="2" style="transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1); opacity: 0; z-index: 1;">
                                            <img src="gambar/dpm2.jpg" alt="Teknologi Digital" class="w-full h-full object-cover">
                                        </div>
                                        <!-- Slide 4 -->
                                        <div class="main-slide absolute inset-0 transition-opacity duration-1000 opacity-0" data-index="3" style="transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1); opacity: 0; z-index: 1;">
                                            <img src="gambar/dpm4.jpg" alt="Investasi dan Bisnis" class="w-full h-full object-cover">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Floating fingers (left side) -->
                            <div class="absolute left-4 top-8 z-20 animate-float-delay-1">
                                <div class="bg-white p-2 rounded-lg shadow-lg transform -rotate-6 cursor-pointer hover:scale-105 transition-transform duration-300 ripple" onclick="showSlideByIndex(0)">
                                    <img src="gambar/dpm3.jpg" alt="Pelayanan Publik" class="w-36 h-28 object-cover rounded-md" data-slide-index="0">
                                </div>
                            </div>

                            <div class="absolute left-8 bottom-8 z-20 animate-float-delay-2">
                                <div class="bg-white p-2 rounded-lg shadow-lg transform rotate-3 cursor-pointer hover:scale-105 transition-transform duration-300 ripple" onclick="showSlideByIndex(1)">
                                    <img src="gambar/SPP-PAKAL.jpeg" alt="Investasi Surabaya" class="w-32 h-24 object-cover rounded-md" data-slide-index="1">
                                </div>
                            </div>

                            <!-- Floating fingers (right side) -->
                            <div class="absolute right-4 top-8 z-20 animate-float-delay-3">
                                <div class="bg-white p-2 rounded-lg shadow-lg transform rotate-6 cursor-pointer hover:scale-105 transition-transform duration-300 ripple" onclick="showSlideByIndex(2)">
                                    <img src="gambar/dpm2.jpg" alt="Teknologi Informasi" class="w-36 h-28 object-cover rounded-md" data-slide-index="2">
                                </div>
                            </div>

                            <div class="absolute right-8 bottom-8 z-20 animate-float-delay-4">
                                <div class="bg-white p-2 rounded-lg shadow-lg transform -rotate-3 cursor-pointer hover:scale-105 transition-transform duration-300 ripple" onclick="showSlideByIndex(3)">
                                    <img src="gambar/dpm4.jpg" alt="Perizinan Digital" class="w-32 h-24 object-cover rounded-md" data-slide-index="3">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Floating icons dengan animasi baru -->
                        <div class="absolute -top-12 -left-12 w-16 h-16 bg-yellow-400 rounded-full flex items-center justify-center shadow-2xl z-40 animate-jelly">
                            <i class="fas fa-dollar-sign text-blue-800 text-2xl animate-icon-bounce"></i>
                        </div>
                        
                        <div class="absolute -top-12 -right-12 w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-2xl animate-rotate-3d z-40">
                            <div class="w-16 h-16 bg-red-600 rounded-full flex items-center justify-center animate-pulse-soft">
                                <span class="text-white font-bold text-sm">SBY</span>
                            </div>
                        </div>
                        
                        <div class="absolute -bottom-14 left-1/4 w-14 h-14 bg-yellow-400 rounded-full flex items-center justify-center shadow-2xl z-40 animate-bounce-soft">
                            <i class="fas fa-building text-blue-700 text-xl"></i>
                        </div>
                        
                        <div class="absolute -bottom-14 right-1/4 w-14 h-14 bg-yellow-400 rounded-full flex items-center justify-center shadow-2xl z-40 animate-bounce-soft">
                            <i class="fas fa-chart-line text-blue-700 text-lg"></i>
                        </div>
                        
                        <!-- Navigation dots -->
                        <div class="flex justify-center space-x-2 mt-6">
                            <div class="slide-dot w-3 h-3 rounded-full cursor-pointer hover:scale-125 transition-transform bg-white/50" data-index="0"></div>
                            <div class="slide-dot w-3 h-3 rounded-full cursor-pointer hover:scale-125 transition-transform bg-white scale-125" data-index="1"></div>
                            <div class="slide-dot w-3 h-3 bg-white/50 rounded-full cursor-pointer hover:scale-125 transition-transform" data-index="2"></div>
                            <div class="slide-dot w-3 h-3 bg-white/50 rounded-full cursor-pointer hover:scale-125 transition-transform" data-index="3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

<section class="py-20 bg-gray-50">
  <div class="container mx-auto px-4 grid grid-cols-1 lg:grid-cols-4 gap-8">

    <!-- SIDEBAR -->
    <aside class="bg-white rounded-2xl shadow p-6">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center">
          <i class="fas fa-bars"></i>
        </div>
        <h3 class="font-bold text-blue-700">Menu Informasi</h3>
      </div>

      <div class="space-y-2">
        {menuOrder.map((m, i) => (
          <button
            class={`menu-btn w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition
            ${i === 0 ? "bg-blue-600 text-white" : "bg-gray-100 hover:bg-blue-50 text-gray-700"}`}
            data-category={m.key}
          >
            <i class={`fas ${m.icon}`}></i>
            {m.label}
          </button>
        ))}
      </div>
    </aside>

    <!-- CONTENT -->
    <div class="lg:col-span-3">
      <div id="content-area" class="bg-white rounded-2xl shadow p-10 space-y-10">

        {contents.map((item) => (
          item.category === "sambutan" ? ( 
            <!-- SAMBUTAN -->
            <div>
              <div class="flex items-center gap-3 mb-2">
                <div class="w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center">
                  <i class="fas fa-microphone"></i>
                </div>
                <h2 class="text-3xl font-bold text-blue-700">Sambutan</h2>
              </div>

              <p class="text-gray-500 mb-6">
                Kepala Dinas DPM-PTSP Kota Surabaya
              </p>

              <div class="bg-blue-50 border-l-4 border-blue-600 rounded-xl p-6 italic leading-relaxed text-gray-700">
                {item.content}
              </div>

              <div class="text-right mt-6">
                <p class="font-semibold text-blue-700">Kepala Dinas DPM-PTSP</p>
                <p class="text-sm text-gray-500">Kota Surabaya</p>
              </div>
            </div>
          ) : (
            <!-- SEMUA NON SAMBUTAN (TERMASUK IKM) -->
            <div class={item.category === "ikm" ? "text-center" : ""}>
              <h2 class="text-2xl font-bold text-blue-700 mb-6">
                {item.title}
              </h2>

              {item.file ? (
                <img
                  src={`https://dpm-ptsp.surabaya.go.id/tentangfile/${item.file}`}
                  alt={item.title}
                  class={`rounded-xl shadow mx-auto ${
                    item.category === "ikm" ? "max-w-md" : "max-w-full"
                  }`}
                />
              ) : (
                <p class="text-gray-500">File tidak tersedia.</p>
              )}
            </div>
          )
        ))}

      </div>
    </div>
  </div>
</section>
</MainLayout>

<script>
const buttons = document.querySelectorAll(".menu-btn");
const contentArea = document.getElementById("content-area");
const BASE_URL = "https://parkir.dpmptsp-surabaya.my.id";

buttons.forEach(btn => {
  btn.addEventListener("click", async () => {
    buttons.forEach(b => b.classList.remove("bg-blue-600","text-white"));
    btn.classList.add("bg-blue-600","text-white");

    const category = btn.dataset.category;
    contentArea.innerHTML = '<p class="text-center text-gray-500">Memuat...</p>';

    const res = await fetch(`${BASE_URL}/api/v1/about-me/${category}`);
    const json = await res.json();
    const data = json?.data?.data || [];

    if (!data.length) {
      contentArea.innerHTML = '<p class="text-center text-gray-500">Data tidak tersedia.</p>';
      return;
    }

    contentArea.innerHTML = data.map(item => {
      if (item.category === "sambutan") {
        return `
          <div class="italic bg-blue-50 p-6 rounded-xl border-l-4 border-blue-600">
            ${item.content}
          </div>
        `;
      }

      return `
        <div class="${item.category === "ikm" ? "text-center" : ""}">
          <h2 class="text-2xl font-bold text-blue-700 mb-6">${item.title}</h2>
          ${
            item.file
              ? `<img src="https://dpm-ptsp.surabaya.go.id/tentangfile/${item.file}" class="rounded-xl shadow mx-auto ${item.category === "ikm" ? "max-w-md" : "max-w-full"}" />`
              : `<p class="text-gray-500">File tidak tersedia.</p>`
          }
        </div>
      `;
    }).join("");
  });
});
</script>
