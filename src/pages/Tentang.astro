<script>
const BASE_URL = "https://parkir.dpmptsp-surabaya.my.id";
const tabs = document.querySelectorAll(".tab-btn");
const contentArea = document.getElementById("content-area");

async function loadCategory(category) {
  contentArea.innerHTML = `
    <p class="text-gray-500 text-center">Memuat data...</p>
  `;

  try {
    const res = await fetch(`${BASE_URL}/api/v1/about-me/${category}`);
    const json = await res.json();

    // API: { data: { category, data: [] } }
    const list = json?.data?.data || [];

    if (!Array.isArray(list) || list.length === 0) {
      contentArea.innerHTML = `
        <p class="text-gray-500 text-center">
          Data tidak tersedia.
        </p>
      `;
      return;
    }

    contentArea.innerHTML = list.map(item => `
      <article class="mb-12 last:mb-0">
        <h2 class="text-3xl font-bold text-blue-800 mb-6">
          ${item.title}
        </h2>

        ${
          // ðŸ”¥ KHUSUS SAMBUTAN â†’ TANPA GAMBAR
          category !== "sambutan" && item.file
            ? `<img
                src="${BASE_URL}/storage/${item.file}"
                alt="${item.title}"
                class="rounded-xl shadow max-w-md mx-auto mb-6"
              />`
            : ""
        }

        ${
          item.content && item.content.trim() !== ""
            ? `<div class="prose max-w-none text-gray-700">
                ${item.content}
              </div>`
            : `<p class="text-gray-500 italic">
                Tidak ada deskripsi.
              </p>`
        }

        <p class="text-sm text-gray-400 mt-4">
          Dipublikasikan:
          ${new Date(item.created_at).toLocaleDateString("id-ID")}
        </p>
      </article>
    `).join("");

  } catch (err) {
    console.error(err);
    contentArea.innerHTML = `
      <p class="text-red-500 text-center">
        Gagal memuat data.
      </p>
    `;
  }
}

// EVENT TAB
tabs.forEach((btn, index) => {
  btn.addEventListener("click", () => {
    tabs.forEach(b =>
      b.classList.remove("bg-blue-600", "text-white")
    );
    btn.classList.add("bg-blue-600", "text-white");

    loadCategory(btn.dataset.category);
  });

  // AUTO LOAD TAB PERTAMA
  if (index === 0) {
    loadCategory(btn.dataset.category);
  }
});
</script>
