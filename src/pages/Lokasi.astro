---
import MainLayout from "../layouts/MainLayout.astro";
import { db } from '../lib/db.js';
import { slugify } from "../utils/slugify";

const lokasiLayanan = [
  {
    nama: "PTSP Pusat",
    deskripsi: "Kantor pusat pelayanan perizinan dan penanaman modal di Kota Surabaya.",
    alamat: "Jl. Tunjungan No.1–3 Lantai 1, Surabaya 60275",
    warna: "blue",
    maps: "https://maps.google.com/?q=Jl.+Tunjungan+No.1+Surabaya",
    images: [
      "https://dpm-ptsp.surabaya.go.id/images/ptsppst2.jpeg",
      "/img/ptsp-pusat/2.jpg",
      "/img/ptsp-pusat/3.jpg"
    ]
  },
  {
    nama: "SPP Menur",
    deskripsi: "Unit pelayanan perizinan dan investasi wilayah Surabaya Timur.",
    alamat: "Jl. Raya Menur No.31 C, Manyar Sabrangan, Surabaya",
    warna: "yellow",
    maps: "https://maps.google.com/?q=Jl.+Raya+Menur+No.31+Surabaya",
    images: [
      "https://dpm-ptsp.surabaya.go.id/images/UPTSATMBARU.jpeg",
      "/img/ptsp-timur/2.jpg"
    ]
  },
  {
    nama: "Klinik Investasi",
    deskripsi: "Layanan konsultasi dan pendampingan investasi bagi pelaku usaha.",
    alamat: "Gedung Siola, Kec. Genteng, Surabaya",
    warna: "blue",
    maps: "https://maps.google.com/?q=Siola+Surabaya",
    images: ["https://dpm-ptsp.surabaya.go.id/images/klinikinvestasi.jpeg"]
  },
  {
    nama: "SPP Joyoboyo",
    deskripsi: "Sentra Pelayanan Publik wilayah Joyoboyo.",
    alamat: "Jl. Joyoboyo No.1 Lantai 3, Surabaya",
    warna: "yellow",
    maps: "https://maps.google.com/?q=SPP+Joyoboyo+Surabaya",
    images: ["https://dpm-ptsp.surabaya.go.id/images/SPP-JOYOBOYO-1.jpeg"]
  },
  {
    nama: "SPP Pakal",
    deskripsi: "Sentra Pelayanan Publik wilayah Pakal.",
    alamat: "Kec. Pakal, Surabaya",
    warna: "yellow",
    maps: "https://maps.google.com/?q=SPP+Pakal+Surabaya",
    images: ["https://dpm-ptsp.surabaya.go.id/images/SPP-PAKAL.jpeg"]
  },
  {
    nama: "SPP Nambangan",
    deskripsi: "Sentra Pelayanan Publik wilayah Nambangan.",
    alamat: "Jl. Nambangan, Kec. Kenjeran, Surabaya",
    warna: "blue",
    maps: "https://maps.google.com/?q=SPP+Nambangan+Surabaya",
    images: ["https://dpm-ptsp.surabaya.go.id/images/SPP-NAMBANGAN.jpeg"]
  }
];




---
<MainLayout title="DPMPTSP Surabaya - Berita & Artikel">
   <section class="relative overflow-hidden gradient-flow bg-gradient-to-r from-blue-800 via-blue-700 to-blue-600">
            <div class="absolute inset-0 z-0">
                <div class="absolute top-0 right-0 w-64 h-64 bg-yellow-400 rounded-full opacity-10 -translate-y-32 translate-x-32 animate-pulse-soft"></div>
                <div class="absolute bottom-0 left-0 w-96 h-96 bg-blue-600 rounded-full opacity-10 -translate-x-64 translate-y-64 animate-pulse-soft"></div>
                <div class="absolute top-1/2 left-1/4 w-48 h-48 bg-white rounded-full opacity-5 animate-float-subtle"></div>
            </div>
            <div class="container mx-auto px-4 py-20 relative z-10">
                <div class="text-center text-white animate-fade-in-scale">
                    <h1 class="text-5xl md:text-6xl font-bold mb-6 animate-text-reveal">
                        Lokasi Pelayanan DPM-PTSP Surabaya
                    </h1>
                    <p class="text-xl opacity-90 max-w-3xl mx-auto animate-slide-in-left">
                        Temukan kantor pelayanan terdekat untuk mendapatkan layanan perizinan dan investasi di Surabaya
                    </p>
                    <div class="mt-8 flex justify-center">
                        <div class="animate-bounce-soft">
                            <i class="fas fa-chevron-down text-2xl text-yellow-400"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="container mx-auto px-4 py-20 space-y-24">

{lokasiLayanan.map((lokasi, i) => (
  <article class="relative bg-white rounded-3xl shadow-2xl p-6 lg:p-10">

    <!-- Accent Bar -->
    <div class={`absolute top-0 left-0 h-2 w-full rounded-t-3xl ${
      lokasi.warna === "blue" ? "bg-blue-700" : "bg-yellow-400"
    }`}></div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">

      <!-- SLIDER -->
      <div class="relative overflow-hidden rounded-2xl border bg-gray-100">

        <div class="flex transition-transform duration-700"
             data-slider={`s-${i}`}>

          {(lokasi.images.length ? lokasi.images : ["/img/placeholder.jpg"]).map(img => (
            <img
              src={img}
              alt={lokasi.nama}
              class="w-full h-72 md:h-80 object-cover flex-shrink-0"
            />
          ))}
        </div>

        <!-- Arrow -->
        <button data-prev={`s-${i}`} class="slider-btn left-3">‹</button>
        <button data-next={`s-${i}`} class="slider-btn right-3">›</button>

        <!-- Dots -->
        <div class="absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-2">
          {(lokasi.images.length ? lokasi.images : [1]).map((_, d) => (
            <span class="dot" data-dot={`s-${i}`} data-index={d}></span>
          ))}
        </div>
      </div>

      <!-- INFO -->
      <div>
        <h2 class={`text-3xl font-bold mb-3 ${
          lokasi.warna === "blue" ? "text-blue-800" : "text-yellow-500"
        }`}>
          {lokasi.nama}
        </h2>

        <p class="text-gray-600 mb-6 leading-relaxed">
          {lokasi.deskripsi}
        </p>

        <div class="flex gap-3 mb-6">
          <i class="fas fa-map-marker-alt text-xl text-gray-500"></i>
          <span class="text-gray-700">{lokasi.alamat}</span>
        </div>

        <a href={lokasi.maps} target="_blank"
           class={`inline-flex items-center px-7 py-3 rounded-xl font-semibold transition ${
             lokasi.warna === "blue"
               ? "bg-blue-700 hover:bg-blue-800 text-white"
               : "bg-yellow-400 hover:bg-yellow-300 text-blue-900"
           }`}>
          <i class="fas fa-map mr-2"></i>
          Lihat di Google Maps
        </a>
      </div>

    </div>
  </article>
))}

</section>


</MainLayout>
<script is:inline>
document.querySelectorAll('[data-slider]').forEach(slider => {
  let index = 0;
  const slides = slider.children.length;
  const name = slider.dataset.slider;
  const dots = document.querySelectorAll(`[data-dot="${name}"]`);

  const update = () => {
    slider.style.transform = `translateX(-${index * 100}%)`;
    dots.forEach(d => d.classList.remove("active"));
    dots[index]?.classList.add("active");
  };

  document.querySelector(`[data-next="${name}"]`).onclick = () => {
    index = (index + 1) % slides; update();
  };

  document.querySelector(`[data-prev="${name}"]`).onclick = () => {
    index = (index - 1 + slides) % slides; update();
  };

  dots.forEach(d => d.onclick = () => {
    index = +d.dataset.index; update();
  });

  setInterval(() => {
    index = (index + 1) % slides; update();
  }, 5000);

  update();
});
</script>
